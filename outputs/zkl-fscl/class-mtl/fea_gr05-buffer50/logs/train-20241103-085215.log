24-11-03 08:52:15 | New ./outputs/zkl-fscl/class-mtl/fea_gr05-buffer50/logs/train-20241103-085215.log.
24-11-03 08:52:15 | Save ./outputs/zkl-fscl/class-mtl/fea_gr05-buffer50/configs/train.yaml.
24-11-03 08:52:15 | Args: 
{'alpha': 1,
 'base_pretrain': True,
 'base_pretrain_model_path': 'weights/class-mtl05.pth',
 'base_pretrain_non_default': True,
 'batch_num': 1,
 'batch_size': 5,
 'batch_size_non_default': True,
 'beta': 1,
 'buffer_size': 50,
 'buffer_size_non_default': True,
 'config': './configs/mtl.yaml',
 'config_non_default': True,
 'dataset': 'class-mtl',
 'dataset_args': {'data_root': '/home/zkl/Documents/Data/AQA/Sequence/MTL-AQA/new',
                  'frame_length': 103,
                  'label_path': '/home/zkl/Documents/Data/AQA/Sequence/MTL-AQA/info/final_annotations_dict_with_dive_number.pkl',
                  'temporal_shift': [-3, 3],
                  'test_split': '/home/zkl/Documents/Data/AQA/Sequence/MTL-AQA/info/test_split_0.pkl',
                  'train_split': '/home/zkl/Documents/Data/AQA/Sequence/MTL-AQA/info/train_split_0.pkl',
                  'usingDD': False},
 'dataset_non_default': True,
 'debug_mode': False,
 'disable_log': False,
 'e_lambda': 1,
 'exp_dir': './outputs/zkl-fscl/class-mtl/fea_gr05-buffer50',
 'exp_name': 'fea_gr05-buffer50',
 'feature_extractor': 'backbone.I3D_backbone.I3D_backbone',
 'feature_extractor_args': {'I3D_ckpt_path': './weights/model_rgb.pth',
                            'I3D_class': 400},
 'fewshot': True,
 'fewshot_non_default': True,
 'gamma': 1,
 'gpus': [2, 3],
 'gpus_non_default': True,
 'ignore_other_metrics': False,
 'local_rank': 0,
 'log_dir': './outputs/zkl-fscl/class-mtl/fea_gr05-buffer50/logs',
 'log_file': './outputs/zkl-fscl/class-mtl/fea_gr05-buffer50/logs/train-20241103-085215.log',
 'logging': <Logger MAGR-github (INFO)>,
 'lr': 0.0001,
 'minibatch_size': 3,
 'minibatch_size_non_default': True,
 'model': 'fea_gr',
 'model_non_default': True,
 'n_epochs': 50,
 'n_epochs_non_default': True,
 'n_tasks': 5,
 'n_tasks_non_default': True,
 'noise_level': 10,
 'non_verbose': False,
 'num_samples_per_task': 20,
 'num_workers': 16,
 'optim_mom': 0.0,
 'optim_nesterov': 0,
 'optim_wd': 0.0,
 'output_device': device(type='cuda', index=0),
 'phase': 'train',
 'pretrain': False,
 'proj_name': 'MAGR-github',
 'projector': 'backbone.Projector.Projector',
 'projector_args': {'in_channels': 1024},
 'regressor': 'backbone.DAE.DAE',
 'regressor_args': {'in_channels': 1024, 'out_channels': 1},
 'seed': 1024,
 'timestamp': '20241103-085215',
 'user': 'zkl',
 'validation': False,
 'weight_decay': 1e-05,
 'weight_path': None,
 'weight_save_path': './outputs/zkl-fscl/class-mtl/fea_gr05-buffer50/weights/weight.pth'}
24-11-03 08:52:15 | Initialize seed with 1024
24-11-03 08:52:15 | Load dataset: class-mtl (class-il)
24-11-03 08:52:15 | Load model: fea_gr (12,287,264 + 295,554)
24-11-03 08:52:33 | Evaluate T01, 254 samples, rho:-14.53 %, p: 0.0206, L2: 4588.66, RL2:    49.38
24-11-03 08:52:38 | Evaluate T02,  20 samples, rho: 30.16 %, p: 0.1962, L2: 1284.88, RL2:    60.72
24-11-03 08:52:38 |       T01-02, 274 samples, rho:-17.68 %, p: 0.0033, L2: 4347.51, RL2:    39.81
24-11-03 08:52:43 | Evaluate T03,  20 samples, rho:-44.70 %, p: 0.0482, L2: 3180.57, RL2:  2884.87
24-11-03 08:52:43 |       T01-03, 294 samples, rho:-17.09 %, p: 0.0033, L2: 4268.13, RL2:    39.08
24-11-03 08:52:48 | Evaluate T04,  20 samples, rho:-38.54 %, p: 0.0933, L2: 4696.67, RL2: 11466.48
24-11-03 08:52:48 |       T01-04, 314 samples, rho:-17.14 %, p: 0.0023, L2: 4295.42, RL2:    39.33
24-11-03 08:52:53 | Evaluate T05,  20 samples, rho:  5.06 %, p: 0.8323, L2: 5554.34, RL2: 19047.82
24-11-03 08:52:53 |       T01-05, 334 samples, rho:-16.27 %, p: 0.0029, L2: 4370.81, RL2:    40.02
24-11-03 08:52:58 | Evaluate T06,  20 samples, rho: 39.97 %, p: 0.0808, L2: 7099.76, RL2:  8480.11
24-11-03 08:52:58 |       T01-06, 354 samples, rho:-14.65 %, p: 0.0057, L2: 4524.98, RL2:    41.44
24-11-03 08:52:58 | ------------| Task 01 |-------------
24-11-03 08:52:59 | Load pretrained model state from weights/class-mtl05.pth.
24-11-03 08:52:59 | The current metrics: 
{'L2': 58.307181732578684,
 'RL2': 0.6274339040798483,
 'p': 5.984641491377956e-97,
 'rho': 90.75673367941981}
24-11-03 08:52:59 | Learning slowly ...
24-11-03 08:52:59 | Current task 1 - select 10 samples
24-11-03 08:54:41 | Task 1 has 10 samples in the buffer.
24-11-03 08:54:59 | Evaluate T01, 254 samples, rho: 90.76 %, p: 0.0000, L2:   58.29, RL2:     0.63
24-11-03 08:54:59 | Rho: 90.76 %
24-11-03 08:54:59 | Rho (overall): 90.76 %
24-11-03 08:55:00 | ------------| Task 02 |-------------
24-11-03 08:55:04 | Evaluate T02,  20 samples, rho: 45.81 %, p: 0.0422, L2:  177.54, RL2:     8.39
24-11-03 09:00:26 | Current task 2 - select 10 samples
24-11-03 09:00:36 | Task 1 has 10 samples in the buffer.
24-11-03 09:00:36 | Task 2 has 10 samples in the buffer.
24-11-03 09:00:54 | Evaluate T01, 254 samples, rho: 90.45 %, p: 0.0000, L2:  158.59, RL2:     1.71
24-11-03 09:00:58 | Evaluate T02,  20 samples, rho: 23.24 %, p: 0.3241, L2:  125.51, RL2:     5.93
24-11-03 09:00:58 |       T01-02, 274 samples, rho: 91.10 %, p: 0.0000, L2:  156.17, RL2:     1.43
24-11-03 09:00:58 | Rho: 56.84 %
24-11-03 09:00:58 | Rho (overall): 91.10 %
24-11-03 09:00:59 | ------------| Task 03 |-------------
24-11-03 09:01:04 | Evaluate T03,  20 samples, rho:-21.22 %, p: 0.3691, L2:  109.43, RL2:    99.26
24-11-03 09:06:36 | Current task 3 - select 10 samples
24-11-03 09:06:46 | Task 1 has 10 samples in the buffer.
24-11-03 09:06:46 | Task 2 has 10 samples in the buffer.
24-11-03 09:06:46 | Task 3 has 10 samples in the buffer.
24-11-03 09:07:04 | Evaluate T01, 254 samples, rho: 89.50 %, p: 0.0000, L2:   85.92, RL2:     0.92
24-11-03 09:07:09 | Evaluate T02,  20 samples, rho: 42.80 %, p: 0.0598, L2:  194.50, RL2:     9.19
24-11-03 09:07:09 |       T01-02, 274 samples, rho: 90.51 %, p: 0.0000, L2:   93.84, RL2:     0.86
24-11-03 09:07:14 | Evaluate T03,  20 samples, rho:-19.86 %, p: 0.4011, L2:   43.63, RL2:    39.57
24-11-03 09:07:14 |       T01-03, 294 samples, rho: 89.96 %, p: 0.0000, L2:   90.43, RL2:     0.83
24-11-03 09:07:14 | Rho: 37.48 %
24-11-03 09:07:14 | Rho (overall): 89.96 %
24-11-03 09:07:14 | ------------| Task 04 |-------------
24-11-03 09:07:20 | Evaluate T04,  20 samples, rho: 28.53 %, p: 0.2227, L2:   59.76, RL2:   145.90
24-11-03 09:13:10 | Current task 4 - select 10 samples
24-11-03 09:13:21 | Task 1 has 10 samples in the buffer.
24-11-03 09:13:21 | Task 2 has 10 samples in the buffer.
24-11-03 09:13:21 | Task 3 has 10 samples in the buffer.
24-11-03 09:13:21 | Task 4 has 10 samples in the buffer.
24-11-03 09:13:38 | Evaluate T01, 254 samples, rho: 88.56 %, p: 0.0000, L2:   88.66, RL2:     0.95
24-11-03 09:13:43 | Evaluate T02,  20 samples, rho: 45.66 %, p: 0.0430, L2:  287.30, RL2:    13.58
24-11-03 09:13:43 |       T01-02, 274 samples, rho: 89.79 %, p: 0.0000, L2:  103.16, RL2:     0.94
24-11-03 09:13:48 | Evaluate T03,  20 samples, rho:-20.77 %, p: 0.3796, L2:   69.75, RL2:    63.26
24-11-03 09:13:48 |       T01-03, 294 samples, rho: 89.05 %, p: 0.0000, L2:  100.89, RL2:     0.92
24-11-03 09:13:53 | Evaluate T04,  20 samples, rho: 10.70 %, p: 0.6535, L2:   31.58, RL2:    77.10
24-11-03 09:13:53 |       T01-04, 314 samples, rho: 88.15 %, p: 0.0000, L2:   96.48, RL2:     0.88
24-11-03 09:13:53 | Rho: 31.04 %
24-11-03 09:13:53 | Rho (overall): 88.15 %
24-11-03 09:13:54 | ------------| Task 05 |-------------
24-11-03 09:13:59 | Evaluate T05,  20 samples, rho: -9.96 %, p: 0.6760, L2:   60.34, RL2:   206.94
24-11-03 09:19:54 | Current task 5 - select 10 samples
24-11-03 09:20:05 | Task 1 has 10 samples in the buffer.
24-11-03 09:20:05 | Task 2 has 10 samples in the buffer.
24-11-03 09:20:05 | Task 3 has 10 samples in the buffer.
24-11-03 09:20:05 | Task 4 has 10 samples in the buffer.
24-11-03 09:20:05 | Task 5 has 10 samples in the buffer.
24-11-03 09:20:23 | Evaluate T01, 254 samples, rho: 89.64 %, p: 0.0000, L2:  102.42, RL2:     1.10
24-11-03 09:20:27 | Evaluate T02,  20 samples, rho: 47.54 %, p: 0.0342, L2:  373.23, RL2:    17.64
24-11-03 09:20:27 |       T01-02, 274 samples, rho: 90.82 %, p: 0.0000, L2:  122.19, RL2:     1.12
24-11-03 09:20:32 | Evaluate T03,  20 samples, rho: -5.79 %, p: 0.8083, L2:  123.22, RL2:   111.76
24-11-03 09:20:32 |       T01-03, 294 samples, rho: 90.24 %, p: 0.0000, L2:  122.26, RL2:     1.12
24-11-03 09:20:38 | Evaluate T04,  20 samples, rho:  9.64 %, p: 0.6861, L2:   30.95, RL2:    75.56
24-11-03 09:20:38 |       T01-04, 314 samples, rho: 89.29 %, p: 0.0000, L2:  116.44, RL2:     1.07
24-11-03 09:20:43 | Evaluate T05,  20 samples, rho: -8.38 %, p: 0.7255, L2:   34.27, RL2:   117.52
24-11-03 09:20:43 |       T01-05, 334 samples, rho: 88.10 %, p: 0.0000, L2:  111.52, RL2:     1.02
24-11-03 09:20:43 | Rho: 26.53 %
24-11-03 09:20:43 | Rho (overall): 88.10 %
24-11-03 09:20:44 | ------------| Task 06 |-------------
24-11-03 09:20:49 | Evaluate T06,  20 samples, rho: 29.62 %, p: 0.2048, L2:   33.66, RL2:    40.21
24-11-03 09:26:45 | Evaluate T01, 254 samples, rho: 88.84 %, p: 0.0000, L2:  206.26, RL2:     2.22
24-11-03 09:26:50 | Evaluate T02,  20 samples, rho: 46.63 %, p: 0.0382, L2:  629.05, RL2:    29.73
24-11-03 09:26:50 |       T01-02, 274 samples, rho: 90.17 %, p: 0.0000, L2:  237.12, RL2:     2.17
24-11-03 09:26:55 | Evaluate T03,  20 samples, rho:-11.89 %, p: 0.6176, L2:  317.68, RL2:   288.15
24-11-03 09:26:55 |       T01-03, 294 samples, rho: 89.45 %, p: 0.0000, L2:  242.60, RL2:     2.22
24-11-03 09:27:00 | Evaluate T04,  20 samples, rho: -3.79 %, p: 0.8738, L2:  120.04, RL2:   293.07
24-11-03 09:27:00 |       T01-04, 314 samples, rho: 88.41 %, p: 0.0000, L2:  234.79, RL2:     2.15
24-11-03 09:27:05 | Evaluate T05,  20 samples, rho: -0.68 %, p: 0.9773, L2:   75.95, RL2:   260.47
24-11-03 09:27:06 |       T01-05, 334 samples, rho: 87.10 %, p: 0.0000, L2:  225.28, RL2:     2.06
24-11-03 09:27:11 | Evaluate T06,  20 samples, rho: 31.05 %, p: 0.1827, L2:   30.49, RL2:    36.41
24-11-03 09:27:11 |       T01-06, 354 samples, rho: 87.57 %, p: 0.0000, L2:  214.28, RL2:     1.96
24-11-03 09:27:11 | Rho: 25.03 %
24-11-03 09:27:11 | Rho (overall): 87.57 %
24-11-03 09:27:12 | Results: 
{'accs': [90.75819876665956,
          56.844894210220914,
          37.47707651617055,
          31.03593444678468,
          26.52813761049514,
          25.028073930165487],
 'accs_mask_classes': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
 'bwt': 4.531507564836649,
 'bwt_mask_classes': 0.0,
 'forgetting': 9.54201594950877,
 'forgetting_mask_classes': 0.0,
 'fullaccs': [[90.75819876665956],
              [90.44796654364353, 23.241821876798298],
              [89.49774758712589, 42.7980474042014, -19.864565442815632],
              [88.55650228995167,
               45.65626498128339,
               -20.76750023567089,
               10.698470751574552],
              [89.63905525139928,
               47.53667128199523,
               -5.793831587487893,
               9.636211244326015,
               -8.377418137756933],
              [88.84164489398707,
               46.63407625765355,
               -11.888641439260873,
               -3.7937839544590615,
               -0.6792501192775893,
               31.054397942349816]],
 'fullaccs_mask_classes': [[0.0],
                           [0.0, 0.0],
                           [0.0, 0.0, -0.0],
                           [0.0, 0.0, -0.0, 0.0],
                           [0.0, 0.0, -0.0, 0.0, -0.0],
                           [0.0, 0.0, -0.0, -0.0, -0.0, 0.0]],
 'fwt': 16.164988902125966,
 'fwt_mask_classes': 0.0}
