24-11-02 19:53:13 | New ./outputs/zkl-fscl/class-mtl/fea_gr05-buffer50/logs/train-20241102-195312.log.
24-11-02 19:53:13 | Save ./outputs/zkl-fscl/class-mtl/fea_gr05-buffer50/configs/train.yaml.
24-11-02 19:53:13 | Args: 
{'alpha': 1,
 'base_pretrain_model_path': 'weights/class-mtl05.pth',
 'batch_num': 1,
 'batch_size': 5,
 'batch_size_non_default': True,
 'beta': 1,
 'buffer_size': 50,
 'buffer_size_non_default': True,
 'config': './configs/mtl_zkl.yaml',
 'config_non_default': True,
 'dataset': 'class-mtl',
 'dataset_args': {'data_root': '/home/zkl/Documents/Data/AQA/Sequence/MTL-AQA/new',
                  'frame_length': 103,
                  'label_path': '/home/zkl/Documents/Data/AQA/Sequence/MTL-AQA/info/final_annotations_dict_with_dive_number.pkl',
                  'temporal_shift': [-3, 3],
                  'test_split': '/home/zkl/Documents/Data/AQA/Sequence/MTL-AQA/info/test_split_0.pkl',
                  'train_split': '/home/zkl/Documents/Data/AQA/Sequence/MTL-AQA/info/train_split_0.pkl',
                  'usingDD': False},
 'dataset_non_default': True,
 'debug_mode': False,
 'disable_log': False,
 'e_lambda': 1,
 'exp_dir': './outputs/zkl-fscl/class-mtl/fea_gr05-buffer50',
 'exp_name': 'fea_gr05-buffer50',
 'feature_extractor': 'backbone.I3D_backbone.I3D_backbone',
 'feature_extractor_args': {'I3D_ckpt_path': './weights/model_rgb.pth',
                            'I3D_class': 400},
 'fewshot': True,
 'fewshot_non_default': True,
 'gamma': 1,
 'gpus': [2, 3],
 'gpus_non_default': True,
 'ignore_other_metrics': False,
 'local_rank': 0,
 'log_dir': './outputs/zkl-fscl/class-mtl/fea_gr05-buffer50/logs',
 'log_file': './outputs/zkl-fscl/class-mtl/fea_gr05-buffer50/logs/train-20241102-195312.log',
 'logging': <Logger MAGR-github (INFO)>,
 'lr': 0.0001,
 'minibatch_size': 3,
 'minibatch_size_non_default': True,
 'model': 'fea_gr',
 'model_non_default': True,
 'n_epochs': 50,
 'n_epochs_non_default': True,
 'n_tasks': 5,
 'n_tasks_non_default': True,
 'noise_level': 10,
 'non_verbose': False,
 'num_samples_per_task': 20,
 'num_workers': 16,
 'optim_mom': 0.0,
 'optim_nesterov': 0,
 'optim_wd': 0.0,
 'output_device': device(type='cuda', index=0),
 'phase': 'train',
 'pretrain': True,
 'pretrain_non_default': True,
 'proj_name': 'MAGR-github',
 'projector': 'backbone.Projector.Projector',
 'projector_args': {'in_channels': 1024},
 'regressor': 'backbone.DAE.DAE',
 'regressor_args': {'in_channels': 1024, 'out_channels': 1},
 'seed': 1024,
 'timestamp': '20241102-195312',
 'user': 'zkl',
 'validation': False,
 'weight_decay': 1e-05,
 'weight_path': './outputs/zkl-fscl/class-mtl/fea_gr05-buffer50/weights/best.pth',
 'weight_save_path': './outputs/zkl-fscl/class-mtl/fea_gr05-buffer50/weights/weight.pth'}
24-11-02 19:53:13 | Initialize seed with 1024
24-11-02 19:53:13 | Load dataset: class-mtl (class-il)
24-11-02 19:53:13 | Load model: fea_gr (12,287,264 + 295,554)
24-11-02 19:53:13 | No pretrained model found at ./outputs/zkl-fscl/class-mtl/fea_gr05-buffer50/weights/best.pth.
24-11-02 19:53:31 | Evaluate T01, 254 samples, rho:-14.53 %, p: 0.0206, L2: 4588.66, RL2:    49.38
24-11-02 19:53:36 | Evaluate T02,  20 samples, rho: 30.16 %, p: 0.1962, L2: 1284.88, RL2:    60.72
24-11-02 19:53:36 |       T01-02, 274 samples, rho:-17.68 %, p: 0.0033, L2: 4347.51, RL2:    39.81
24-11-02 19:53:41 | Evaluate T03,  20 samples, rho:-44.70 %, p: 0.0482, L2: 3180.57, RL2:  2884.87
24-11-02 19:53:41 |       T01-03, 294 samples, rho:-17.09 %, p: 0.0033, L2: 4268.13, RL2:    39.08
24-11-02 19:53:46 | Evaluate T04,  20 samples, rho:-38.54 %, p: 0.0933, L2: 4696.67, RL2: 11466.48
24-11-02 19:53:46 |       T01-04, 314 samples, rho:-17.14 %, p: 0.0023, L2: 4295.42, RL2:    39.33
24-11-02 19:53:51 | Evaluate T05,  20 samples, rho:  5.06 %, p: 0.8323, L2: 5554.34, RL2: 19047.82
24-11-02 19:53:51 |       T01-05, 334 samples, rho:-16.27 %, p: 0.0029, L2: 4370.81, RL2:    40.02
24-11-02 19:53:57 | Evaluate T06,  20 samples, rho: 39.97 %, p: 0.0808, L2: 7099.76, RL2:  8480.11
24-11-02 19:53:57 |       T01-06, 354 samples, rho:-14.65 %, p: 0.0057, L2: 4524.98, RL2:    41.44
24-11-02 19:53:57 | ------------| Task 01 |-------------
24-11-02 19:53:58 | Load pretrained model state from weights/class-mtl05.pth.
24-11-02 19:53:58 | The current metrics: 
{'L2': 58.307181732578684,
 'RL2': 0.6274339040798483,
 'p': 5.984641491377956e-97,
 'rho': 90.75673367941981}
24-11-02 19:53:58 | Freeze layers ...
24-11-02 19:53:58 | Current task 1 - select 10 samples
24-11-02 19:55:39 | Task 1 has 10 samples in the buffer.
24-11-02 19:55:57 | Evaluate T01, 254 samples, rho: 90.76 %, p: 0.0000, L2:   58.29, RL2:     0.63
24-11-02 19:55:57 | Rho: 90.76 %
24-11-02 19:55:57 | Rho (overall): 90.76 %
24-11-02 19:55:58 | ------------| Task 02 |-------------
24-11-02 19:56:02 | Evaluate T02,  20 samples, rho: 45.81 %, p: 0.0422, L2:  177.54, RL2:     8.39
24-11-02 20:00:44 | Current task 2 - select 10 samples
24-11-02 20:00:53 | Task 1 has 10 samples in the buffer.
24-11-02 20:00:53 | Task 2 has 10 samples in the buffer.
24-11-02 20:01:10 | Evaluate T01, 254 samples, rho: 88.98 %, p: 0.0000, L2:  373.48, RL2:     4.02
24-11-02 20:01:15 | Evaluate T02,  20 samples, rho: 19.71 %, p: 0.4050, L2:  116.69, RL2:     5.51
24-11-02 20:01:15 |       T01-02, 274 samples, rho: 89.59 %, p: 0.0000, L2:  354.73, RL2:     3.25
24-11-02 20:01:15 | Rho: 54.34 %
24-11-02 20:01:15 | Rho (overall): 89.59 %
24-11-02 20:01:15 | ------------| Task 03 |-------------
24-11-02 20:01:20 | Evaluate T03,  20 samples, rho:-36.64 %, p: 0.1120, L2:  160.45, RL2:   145.53
24-11-02 20:06:10 | Current task 3 - select 10 samples
24-11-02 20:06:20 | Task 1 has 10 samples in the buffer.
24-11-02 20:06:20 | Task 2 has 10 samples in the buffer.
24-11-02 20:06:20 | Task 3 has 10 samples in the buffer.
24-11-02 20:06:37 | Evaluate T01, 254 samples, rho: 89.46 %, p: 0.0000, L2:   95.92, RL2:     1.03
24-11-02 20:06:42 | Evaluate T02,  20 samples, rho: 43.40 %, p: 0.0559, L2:  205.61, RL2:     9.72
24-11-02 20:06:42 |       T01-02, 274 samples, rho: 90.66 %, p: 0.0000, L2:  103.93, RL2:     0.95
24-11-02 20:06:47 | Evaluate T03,  20 samples, rho:-17.53 %, p: 0.4597, L2:   38.88, RL2:    35.27
24-11-02 20:06:47 |       T01-03, 294 samples, rho: 90.17 %, p: 0.0000, L2:   99.50, RL2:     0.91
24-11-02 20:06:47 | Rho: 38.44 %
24-11-02 20:06:47 | Rho (overall): 90.17 %
24-11-02 20:06:47 | ------------| Task 04 |-------------
24-11-02 20:06:52 | Evaluate T04,  20 samples, rho: 13.58 %, p: 0.5680, L2:   43.76, RL2:   106.83
24-11-02 20:11:59 | Current task 4 - select 10 samples
24-11-02 20:12:09 | Task 1 has 10 samples in the buffer.
24-11-02 20:12:09 | Task 2 has 10 samples in the buffer.
24-11-02 20:12:09 | Task 3 has 10 samples in the buffer.
24-11-02 20:12:09 | Task 4 has 10 samples in the buffer.
24-11-02 20:12:27 | Evaluate T01, 254 samples, rho: 89.34 %, p: 0.0000, L2:   96.25, RL2:     1.04
24-11-02 20:12:32 | Evaluate T02,  20 samples, rho: 40.69 %, p: 0.0750, L2:  335.09, RL2:    15.84
24-11-02 20:12:32 |       T01-02, 274 samples, rho: 90.48 %, p: 0.0000, L2:  113.68, RL2:     1.04
24-11-02 20:12:36 | Evaluate T03,  20 samples, rho:-16.10 %, p: 0.4976, L2:   65.78, RL2:    59.67
24-11-02 20:12:36 |       T01-03, 294 samples, rho: 89.98 %, p: 0.0000, L2:  110.42, RL2:     1.01
24-11-02 20:12:42 | Evaluate T04,  20 samples, rho: 20.64 %, p: 0.3827, L2:   24.89, RL2:    60.77
24-11-02 20:12:42 |       T01-04, 314 samples, rho: 89.06 %, p: 0.0000, L2:  104.98, RL2:     0.96
24-11-02 20:12:42 | Rho: 33.64 %
24-11-02 20:12:42 | Rho (overall): 89.06 %
24-11-02 20:12:42 | ------------| Task 05 |-------------
24-11-02 20:12:47 | Evaluate T05,  20 samples, rho: -2.11 %, p: 0.9295, L2:   54.15, RL2:   185.71
24-11-02 20:17:58 | Current task 5 - select 10 samples
24-11-02 20:18:09 | Task 1 has 10 samples in the buffer.
24-11-02 20:18:09 | Task 2 has 10 samples in the buffer.
24-11-02 20:18:09 | Task 3 has 10 samples in the buffer.
24-11-02 20:18:09 | Task 4 has 10 samples in the buffer.
24-11-02 20:18:09 | Task 5 has 10 samples in the buffer.
24-11-02 20:18:26 | Evaluate T01, 254 samples, rho: 89.24 %, p: 0.0000, L2:  131.99, RL2:     1.42
24-11-02 20:18:31 | Evaluate T02,  20 samples, rho: 34.00 %, p: 0.1425, L2:  529.00, RL2:    25.00
24-11-02 20:18:31 |       T01-02, 274 samples, rho: 90.28 %, p: 0.0000, L2:  160.97, RL2:     1.47
24-11-02 20:18:36 | Evaluate T03,  20 samples, rho:-15.88 %, p: 0.5038, L2:  124.54, RL2:   112.96
24-11-02 20:18:36 |       T01-03, 294 samples, rho: 89.77 %, p: 0.0000, L2:  158.49, RL2:     1.45
24-11-02 20:18:41 | Evaluate T04,  20 samples, rho: 13.73 %, p: 0.5637, L2:   26.94, RL2:    65.77
24-11-02 20:18:41 |       T01-04, 314 samples, rho: 88.88 %, p: 0.0000, L2:  150.11, RL2:     1.37
24-11-02 20:18:46 | Evaluate T05,  20 samples, rho: -2.42 %, p: 0.9195, L2:   30.78, RL2:   105.56
24-11-02 20:18:46 |       T01-05, 334 samples, rho: 87.81 %, p: 0.0000, L2:  142.96, RL2:     1.31
24-11-02 20:18:46 | Rho: 23.74 %
24-11-02 20:18:46 | Rho (overall): 87.81 %
24-11-02 20:18:47 | ------------| Task 06 |-------------
24-11-02 20:18:52 | Evaluate T06,  20 samples, rho: 41.56 %, p: 0.0684, L2:   36.93, RL2:    44.11
24-11-02 20:24:06 | Evaluate T01, 254 samples, rho: 89.28 %, p: 0.0000, L2:  286.22, RL2:     3.08
24-11-02 20:24:10 | Evaluate T02,  20 samples, rho: 23.69 %, p: 0.3145, L2:  952.41, RL2:    45.01
24-11-02 20:24:10 |       T01-02, 274 samples, rho: 90.20 %, p: 0.0000, L2:  334.85, RL2:     3.07
24-11-02 20:24:15 | Evaluate T03,  20 samples, rho:-20.02 %, p: 0.3975, L2:  354.22, RL2:   321.29
24-11-02 20:24:15 |       T01-03, 294 samples, rho: 89.75 %, p: 0.0000, L2:  336.17, RL2:     3.08
24-11-02 20:24:20 | Evaluate T04,  20 samples, rho: 16.69 %, p: 0.4818, L2:  141.03, RL2:   344.30
24-11-02 20:24:20 |       T01-04, 314 samples, rho: 88.92 %, p: 0.0000, L2:  323.74, RL2:     2.96
24-11-02 20:24:26 | Evaluate T05,  20 samples, rho: -0.53 %, p: 0.9824, L2:   88.01, RL2:   301.81
24-11-02 20:24:26 |       T01-05, 334 samples, rho: 87.78 %, p: 0.0000, L2:  309.62, RL2:     2.84
24-11-02 20:24:31 | Evaluate T06,  20 samples, rho: 42.46 %, p: 0.0620, L2:   35.80, RL2:    42.76
24-11-02 20:24:31 |       T01-06, 354 samples, rho: 88.28 %, p: 0.0000, L2:  294.15, RL2:     2.69
24-11-02 20:24:31 | Rho: 25.26 %
24-11-02 20:24:31 | Rho (overall): 88.28 %
24-11-02 20:24:32 | Results: 
{'accs': [90.75819876665956,
          54.3422780193717,
          38.443984662659226,
          33.640960469066854,
          23.736074679080183,
          25.26376155283535],
 'accs_mask_classes': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
 'bwt': -0.4074109457028564,
 'bwt_mask_classes': 0.0,
 'forgetting': 9.616837922441999,
 'forgetting_mask_classes': 0.0,
 'fullaccs': [[90.75819876665956],
              [88.97789800728334, 19.706658031460048],
              [89.46416046215472, 43.39977742042919, -17.531983894606224],
              [89.33600195585804,
               40.691992347404145,
               -16.102337139252064,
               20.638184712257292],
              [89.24084453963658,
               33.99774591687001,
               -15.876603441038254,
               13.733497915141804,
               -2.4151115352092063],
              [89.27648278674337,
               23.69311938896914,
               -20.015054574958178,
               16.692649399619867,
               -0.5283056483270139,
               42.46367796496495]],
 'fullaccs_mask_classes': [[0.0],
                           [0.0, 0.0],
                           [0.0, 0.0, -0.0],
                           [0.0, 0.0, -0.0, 0.0],
                           [0.0, 0.0, -0.0, 0.0, -0.0],
                           [0.0, 0.0, -0.0, 0.0, -0.0, 0.0]],
 'fwt': 14.047919843682298,
 'fwt_mask_classes': 0.0}
